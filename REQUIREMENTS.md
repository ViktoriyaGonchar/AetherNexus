# AetherNexus — Интеллектуальная Ткань Знаний
## PyCharm Plugin Edition — Требования к Проекту

---

## 1. Резюме и Ценностное Предложение

### Проблема
Разработчики теряют до 40% времени на поиск информации в проекте: документации, конфигах, legacy-коде и смежных задачах. Знания фрагментированы между файлами, PR, тикетами и командными чатами.

### Видение
Встроить интеллектуальный слой знаний напрямую в IDE (PyCharm Community), превратив её в центральный узел для доступа ко всей информации проекта. Плагин преобразует код, комментарии и документацию в контекстуализированную, запрашиваемую базу знаний, доступную без переключения контекста.

### Измеримая Ценность для Разработчика
- Сокращение времени поиска информации по проекту на **70%**
- Снижение количества контекстных переключений на **60%**
- Ускорение онбординга новых разработчиков в проект на **50%**
- Автоматическое обнаружение связей между кодом, ошибками и документацией

---

## 2. Ключевые Архитектурные Принципы

- **Микросервисный бэкенд** с событийной архитектурой
- **Локально-первый подход**: Возможность работы с локальной копией бэкенда для полной конфиденциальности
- **Графо-ориентированное представление данных** для связывания сущностей (классы, функции, тикеты, PR)
- **API-first дизайн** с легким SDK для интеграции
- **Минималистичный и ненавязчивый UI** внутри PyCharm
- **Полная оффлайн-работа** с синхронизацией по требованию

---

## 3. Детальная Техническая Архитектура

### 3.1. Бэкенд-Система (Aether-Nexus Core)

#### Слой приема данных
- Индексация Git-репозиториев
- Интеграция с Jira
- Интеграция с Confluence
- Интеграция с Slack (через API)
- Индексация локальных файлов проекта

#### Движок обработки знаний
- Семантическое чанкинг кода и текста
- Генерация векторных эмбеддингов
- Построение графа связей (код → тикет → документация)

#### Гибридный поиск
- Векторный поиск
- Полнотекстовый поиск
- Поиск по графу

### 3.2. Фронтенд: PyCharm Community Plugin

#### UI Компоненты

**Панель Aether-Nexus**
- Sidebar-панель с историей запросов
- Избранное (favorites)
- Быстрый доступ к часто используемым запросам

**Инлайн-ассистент**
- Pop-up окно, вызываемое по хоткею рядом с курсором
- Контекстно-зависимые подсказки
- Автодополнение запросов

**Контекстное меню**
- Пункт "Explain this code" в меню PyCharm
- Пункт "Find related tickets"
- Пункт "Search documentation"
- Интеграция с нативным контекстным меню IDE

#### Функционал плагина

**Поиск в реальном времени**
- Автодополнение запросов
- Поиск по проекту и связанным ресурсам
- Инкрементальный поиск с подсказками

**"Объясни этот код"**
- Отправка выделенного фрагмента кода в движок
- Генерация объяснения на основе контекста проекта
- Отображение связанных тикетов и документации

**"Найди связанное"**
- Автоматический поиск тикетов, связанных с текущим файлом/методом
- Поиск связанных PR
- Поиск связанной документации
- Визуализация связей

**"Сгенерируй документацию"**
- Создание docstring на основе кода и контекста
- Генерация комментариев
- Использование контекста проекта для улучшения качества

**Визуализация графа связей**
- Граф для выбранной сущности (класса, функции)
- Интерактивная навигация по связям
- Фильтрация и поиск в графе

---

## 4. Технологический Стек

### 4.1. Бэкенд-Сервисы

- **API Gateway**: FastAPI (ASGI)
- **Брокер сообщений**: Apache Kafka / Redis Pub/Sub
- **Векторная БД**: Qdrant
- **Графовая БД**: Neo4j
- **Кеш**: Redis
- **Язык**: Python 3.10+

### 4.2. Фронтенд (PyCharm Plugin)

- **Язык**: Kotlin (предпочтительно) / Java
- **SDK**: IntelliJ Platform SDK
- **Минимальная версия IDE**: PyCharm Community 2023.1+
- **UI Framework**: Swing
  - JBUiList для списков
  - JBSplitter для разделения панелей
  - Custom Renderers для кастомного отображения
- **Сетевые запросы**: Apache HttpClient (асинхронный)
- **Парсинг кода**: PSI (Program Structure Interface) PyCharm
- **JSON обработка**: Gson / kotlinx.serialization

---

## 5. Функциональные Требования

### 5.1. Интеграция с IDE

- [ ] Регистрация плагина в PyCharm Marketplace
- [ ] Установка через стандартный менеджер плагинов
- [ ] Настройка через Settings → Tools → AetherNexus
- [ ] Поддержка тем IDE (Light/Dark)
- [ ] Многоязычная поддержка (минимум: EN, RU)

### 5.2. Подключение к бэкенду

- [ ] Настройка URL бэкенд-сервера
- [ ] Настройка API ключа/токена
- [ ] Проверка соединения при старте
- [ ] Автоматическое переподключение при разрыве связи
- [ ] Режим оффлайн с локальным кешем

### 5.3. Индексация проекта

- [ ] Автоматическая индексация открытого проекта
- [ ] Инкрементальная индексация при изменениях
- [ ] Индексация по требованию (ручной запуск)
- [ ] Прогресс-бар индексации
- [ ] Уведомления о завершении индексации

### 5.4. Поиск и запросы

- [ ] Текстовый поиск по проекту
- [ ] Семантический поиск (поиск по смыслу)
- [ ] Поиск по графу связей
- [ ] Фильтрация результатов (по типу: код, документация, тикеты)
- [ ] Сохранение истории запросов
- [ ] Избранные запросы

### 5.5. Контекстные действия

- [ ] "Explain this code" для выделенного кода
- [ ] "Find related tickets" для текущего файла/метода
- [ ] "Search documentation" для выбранной сущности
- [ ] "Generate documentation" для функций/классов
- [ ] Интеграция в контекстное меню

### 5.6. Визуализация

- [ ] Граф связей для выбранной сущности
- [ ] Интерактивная навигация по графу
- [ ] Фильтрация узлов и связей
- [ ] Экспорт графа (PNG, SVG)

---

## 6. Нефункциональные Требования

### 6.1. Производительность

- Время отклика на запрос: < 2 секунды
- Время индексации проекта: < 5 минут для проекта до 10K файлов
- Использование памяти: < 500MB дополнительно к IDE
- Неблокирующий UI (все операции асинхронные)

### 6.2. Надежность

- Обработка ошибок сети с понятными сообщениями
- Восстановление после сбоев
- Валидация данных перед отправкой
- Логирование ошибок для отладки

### 6.3. Безопасность

- Безопасное хранение API ключей (шифрование)
- HTTPS для всех соединений
- Валидация сертификатов
- Локальное хранение кеша без передачи на сервер

### 6.4. Удобство использования

- Интуитивный UI
- Подсказки и туториалы при первом запуске
- Настраиваемые хоткеи
- Минимальное обучение (< 5 минут)

### 6.5. Совместимость

- PyCharm Community 2023.1+
- PyCharm Professional 2023.1+
- IntelliJ IDEA (для будущего расширения)
- Windows, macOS, Linux

---

## 7. API Требования (Бэкенд)

### 7.1. Endpoints

**Аутентификация**
- `POST /api/v1/auth/login` - Авторизация
- `POST /api/v1/auth/refresh` - Обновление токена
- `GET /api/v1/auth/validate` - Проверка токена

**Индексация**
- `POST /api/v1/index/project` - Запуск индексации проекта
- `GET /api/v1/index/status` - Статус индексации
- `DELETE /api/v1/index/project/{project_id}` - Удаление индекса

**Поиск**
- `POST /api/v1/search/text` - Текстовый поиск
- `POST /api/v1/search/semantic` - Семантический поиск
- `POST /api/v1/search/graph` - Поиск по графу
- `GET /api/v1/search/history` - История запросов

**Контекст**
- `POST /api/v1/context/explain` - Объяснение кода
- `GET /api/v1/context/related/{entity_id}` - Связанные сущности
- `POST /api/v1/context/generate-docs` - Генерация документации

**Граф**
- `GET /api/v1/graph/entity/{entity_id}` - Граф для сущности
- `GET /api/v1/graph/connections/{entity_id}` - Связи сущности

### 7.2. WebSocket

- `ws://api/v1/notifications` - Real-time уведомления (индексация, обновления)

---

## 8. Структура Проекта

```
AetherNexus/
├── backend/                 # Бэкенд-сервисы (отдельный репозиторий)
│   ├── api-gateway/
│   ├── indexing-service/
│   ├── knowledge-engine/
│   └── search-service/
│
├── pycharm-plugin/         # PyCharm Plugin
│   ├── src/
│   │   ├── main/
│   │   │   ├── kotlin/
│   │   │   │   ├── ui/              # UI компоненты
│   │   │   │   ├── api/             # API клиент
│   │   │   │   ├── services/        # Бизнес-логика
│   │   │   │   ├── models/          # Модели данных
│   │   │   │   └── utils/           # Утилиты
│   │   │   ├── resources/
│   │   │   │   ├── META-INF/
│   │   │   │   │   └── plugin.xml   # Конфигурация плагина
│   │   │   │   └── icons/           # Иконки
│   │   │   └── java/                # Java код (если нужен)
│   │   └── test/                    # Тесты
│   ├── build.gradle.kts
│   └── settings.gradle.kts
│
├── docs/                    # Документация
│   ├── api.md
│   ├── user-guide.md
│   └── development.md
│
├── REQUIREMENTS.md          # Этот файл
├── README.md
└── LICENSE
```

---

## 9. Этапы Разработки (Roadmap)

### Фаза 1: MVP (Минимально жизнеспособный продукт)
- [ ] Базовая структура плагина
- [ ] Подключение к бэкенду
- [ ] Простой текстовый поиск
- [ ] Базовый UI (sidebar панель)

### Фаза 2: Основной функционал
- [ ] Семантический поиск
- [ ] "Explain this code"
- [ ] "Find related tickets"
- [ ] Контекстное меню

### Фаза 3: Расширенные возможности
- [ ] Визуализация графа
- [ ] Генерация документации
- [ ] Оффлайн режим
- [ ] История и избранное

### Фаза 4: Полировка
- [ ] Оптимизация производительности
- [ ] Улучшение UI/UX
- [ ] Расширенная документация
- [ ] Подготовка к публикации

---

## 10. Зависимости и Инструменты

### Для разработки плагина
- IntelliJ IDEA (для разработки плагина)
- JDK 17+
- Gradle 8.0+
- Kotlin 1.9+

### Для тестирования
- PyCharm Community (тестовая среда)
- JUnit 5
- Mockito (для моков)

### Для сборки и публикации
- Gradle Plugin для IntelliJ Platform
- Marketplace Publisher Plugin

---

## 11. Метрики Успеха

- Время отклика на запрос < 2 сек (95-й перцентиль)
- Успешная установка и запуск на 95%+ систем
- Позитивные отзывы пользователей (> 4.0/5.0)
- Сокращение времени поиска информации на 70% (измеряется через аналитику)

---

## 12. Риски и Митигация

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Несовместимость с новыми версиями IDE | Средняя | Высокое | Регулярное тестирование на новых версиях |
| Производительность при больших проектах | Средняя | Среднее | Оптимизация индексации, пагинация |
| Сложность интеграции с бэкендом | Низкая | Среднее | Четкое API, моки для разработки |
| Изменения в IntelliJ Platform SDK | Низкая | Высокое | Мониторинг изменений, адаптация |

---

**Версия документа**: 1.0  
**Дата создания**: 2024  
**Статус**: Требования определены, готово к разработке

